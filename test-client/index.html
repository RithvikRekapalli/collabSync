<!DOCTYPE html>
<html>
<head>
  <title>Realtime Collaboration Test</title>
</head>
<body>
  <h2>Doc Collaboration (doc_id = 123)</h2>
  <textarea id="editor" rows="10" cols="50" placeholder="Start typing..."></textarea>

  <script>
    const docId = "123";
    const ws = new WebSocket(`ws://localhost:8000/ws/${docId}`);
    const editor = document.getElementById("editor");
    let isLocalChange = false;

    ws.onmessage = (event) => {
      if (!isLocalChange) {
        editor.value = event.data;
      }
    };

    editor.addEventListener("input", () => {
      isLocalChange = true;
      ws.send(editor.value);
      setTimeout(() => isLocalChange = false, 50);
    });
  </script>
</body>
</html>
